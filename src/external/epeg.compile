#!/bin/bash

if [ -f '../libepeg.a' ]; then exit; fi

export CC=gcc
export CFLAGS=-fPIC
export LDFLAGS=

tar xzf thumbs.tar.gz
cd thumbs

cd jpeg-8d && \
./configure --enable-static --disable-shared --with-pic > /dev/null && \
make > /dev/null && \
cd ..

export CPPFLAGS="$CPPFLAGS -I$(pwd)/jpeg-8d/"

cd epeg &&
./configure --enable-static --disable-shared --with-pic > /dev/null &&
make > /dev/null 2> /dev/null
cd ..

cd .. &&
cp thumbs/epeg/src/lib/.libs/libepeg.a thumbs/jpeg-8d/.libs/libjpeg.a ../ &&
rm -rf thumbs

#export JPEG_LIB_VERSION="80"

#cd ../libjpeg-turbo-1.2.90
#./configure --enable-static --disable-shared --libdir=/usr/local/lib
#make 2> /dev/null
#cp /usr/local/lib/libturbojpeg.a ../../../lib/
#cp /usr/local/lib/libepeg.a ../../../lib/
#cd ..
